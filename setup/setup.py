import zipfile
import os

setupfiles = "80;75;3;4;10;3;0;0;0;0;26;90;230;84;1;254;130;172;207;2;0;0;207;2;0;0;11;0;0;0;102;97;118;105;99;111;110;46;112;110;103;137;80;78;71;13;10;26;10;0;0;0;13;73;72;68;82;0;0;0;32;0;0;0;32;8;6;0;0;0;115;122;122;244;0;0;1;132;105;67;67;80;73;67;67;32;112;114;111;102;105;108;101;0;0;40;145;125;145;61;72;195;64;28;197;95;91;75;69;42;10;102;16;113;200;208;58;89;16;21;113;212;42;20;161;66;168;21;90;117;48;185;244;11;154;24;146;20;23;71;193;181;224;224;199;98;213;193;197;89;87;7;87;65;16;252;0;113;116;114;82;116;145;18;255;151;20;90;196;120;112;220;143;119;247;30;119;239;128;96;163;202;52;171;107;12;208;116;219;204;164;146;98;46;191;34;70;94;17;65;24;253;16;16;151;153;101;204;74;82;26;190;227;235;30;1;190;222;37;120;150;255;185;63;71;175;90;176;24;16;16;137;103;152;97;218;196;235;196;83;155;182;193;121;159;88;96;101;89;37;62;39;30;53;233;130;196;143;92;87;60;126;227;92;114;57;200;51;5;51;155;153;35;22;136;197;82;7;43;29;204;202;166;70;60;73;28;83;53;157;242;131;57;143;85;206;91;156;181;106;141;181;238;201;95;24;45;232;203;75;92;167;57;140;20;22;176;8;9;34;20;212;80;65;21;54;18;180;234;164;88;200;208;126;210;199;63;228;250;37;114;41;228;170;128;145;99;30;27;208;32;187;126;240;63;248;221;173;85;156;24;247;146;162;73;32;252;226;56;31;113;32;178;11;52;235;142;243;125;236;56;205;19;32;244;12;92;233;109;255;70;3;152;254;36;189;222;214;98;71;64;223;54;112;113;221;214;148;61;224;114;7;24;124;50;100;83;118;165;16;205;96;177;8;188;159;209;55;229;129;129;91;160;103;213;235;173;181;143;211;7;32;75;93;165;111;128;131;67;96;164;68;217;107;62;239;238;238;236;237;223;51;173;254;126;0;67;108;114;148;193;240;34;196;0;0;0;6;98;75;71;68;0;0;0;0;0;0;249;67;187;127;0;0;0;9;112;72;89;115;0;0;11;19;0;0;11;19;1;0;154;156;24;0;0;0;7;116;73;77;69;7;230;7;5;16;27;49;109;249;22;205;0;0;0;204;73;68;65;84;88;195;197;151;203;14;195;32;12;4;215;171;254;255;231;86;189;185;23;168;170;136;16;131;31;32;229;150;100;6;103;141;98;81;85;197;193;245;2;0;17;41;7;171;42;68;68;120;98;215;29;14;0;60;9;47;23;184;194;75;5;70;240;50;129;59;120;137;192;12;158;46;240;4;79;21;176;192;211;4;172;240;20;129;21;120;184;192;42;60;84;96;7;30;38;176;11;15;17;240;192;221;2;13;14;207;63;5;189;59;247;74;208;91;118;175;4;35;190;185;71;130;81;129;219;149;32;128;119;84;218;183;36;218;141;211;107;181;172;253;157;150;231;152;209;231;43;149;96;214;33;99;149;96;214;9;103;150;24;101;32;122;90;154;102;226;42;144;53;170;221;74;252;11;100;207;137;67;137;149;150;73;145;208;182;138;39;164;159;4;123;90;43;5;90;119;124;0;224;11;156;10;4;206;157;249;255;136;0;0;0;0;73;69;78;68;174;66;96;130;80;75;3;4;20;3;0;0;8;0;18;176;230;84;164;61;202;155;4;3;0;0;28;8;0;0;7;0;0;0;109;97;105;110;46;112;121;173;85;81;111;211;48;16;126;207;175;56;204;195;82;109;11;101;32;4;149;34;52;160;192;128;141;9;13;237;101;82;228;36;151;212;170;227;139;108;103;107;17;63;30;39;78;182;180;116;154;38;45;47;137;239;251;238;62;127;62;219;121;254;236;69;42;212;11;84;215;80;175;237;130;212;171;32;16;85;77;218;130;93;10;101;81;3;55;238;51;40;52;85;183;161;129;113;79;188;66;99;120;137;41;173;118;194;198;189;37;230;130;75;42;7;49;50;193;144;220;72;43;106;77;153;43;34;84;25;4;154;200;66;12;103;164;16;2;145;145;234;7;65;80;107;87;55;100;251;135;227;103;159;77;6;224;47;204;79;78;79;190;28;195;233;252;236;55;252;117;192;189;25;65;142;5;100;146;12;134;147;89;0;238;225;202;220;160;134;120;228;38;226;102;185;70;163;40;227;42;67;25;178;185;168;68;201;225;20;85;195;14;128;93;82;35;115;88;83;3;82;44;17;44;193;66;228;8;35;22;8;101;44;242;28;200;171;57;131;239;217;164;211;19;197;32;41;76;231;111;6;26;109;163;213;38;234;162;68;54;106;215;65;20;235;208;231;162;52;216;3;57;26;171;201;1;222;146;110;212;96;200;82;226;70;16;111;172;127;107;201;37;184;121;252;231;230;35;85;21;87;249;12;238;38;168;200;246;101;54;38;231;218;179;221;182;232;220;127;134;150;235;18;109;44;121;149;230;124;70;38;50;107;99;177;10;89;169;168;194;67;139;186;18;138;75;56;60;4;182;239;107;79;188;158;141;140;75;182;131;147;148;155;133;179;242;100;130;221;190;111;139;178;221;122;21;23;183;75;87;74;74;185;236;22;120;60;110;155;208;141;251;45;106;151;209;197;210;183;196;55;195;10;43;113;115;97;71;104;137;84;161;213;235;144;189;121;61;93;77;199;144;43;92;136;50;76;121;182;44;53;53;42;143;217;243;233;244;237;244;227;192;106;165;189;226;249;130;44;157;84;188;196;176;16;18;99;86;240;235;22;141;106;85;142;75;182;177;186;229;134;23;186;193;131;174;194;8;214;104;196;31;158;186;233;126;230;210;56;188;123;77;224;142;81;107;151;156;145;12;247;46;79;147;79;243;31;243;139;121;114;121;114;246;233;231;229;222;129;63;58;147;160;99;87;206;103;202;181;159;94;107;58;108;243;189;86;59;197;164;37;140;208;158;191;69;136;120;158;39;153;223;131;161;131;252;35;121;138;50;222;251;213;168;189;131;219;96;207;138;117;163;124;112;87;41;131;53;215;220;146;14;31;35;52;95;9;187;67;169;179;59;214;90;160;172;239;245;53;16;30;150;59;78;169;217;161;55;236;230;209;85;100;22;116;35;84;65;33;235;114;96;235;240;142;134;144;174;225;27;95;54;233;247;27;174;44;221;172;175;212;245;203;104;122;165;174;86;199;239;54;17;56;154;30;29;177;201;216;88;173;169;212;188;186;207;219;152;243;176;189;15;220;44;118;184;107;79;225;88;179;47;238;75;113;147;241;28;183;75;177;207;66;34;243;73;67;74;124;219;210;187;120;163;114;212;82;40;140;167;143;20;56;247;166;204;182;72;111;246;201;116;190;162;172;183;53;218;205;242;160;192;127;183;69;151;218;75;142;225;246;38;147;68;245;240;179;88;137;238;146;19;5;36;137;226;21;38;9;196;49;176;36;105;137;73;194;102;253;221;247;15;80;75;1;2;63;3;10;3;0;0;0;0;26;90;230;84;1;254;130;172;207;2;0;0;207;2;0;0;11;0;36;0;0;0;0;0;0;0;32;128;164;129;0;0;0;0;102;97;118;105;99;111;110;46;112;110;103;10;0;32;0;0;0;0;0;1;0;24;0;0;90;236;32;25;145;216;1;0;90;236;32;25;145;216;1;0;90;236;32;25;145;216;1;80;75;1;2;63;3;20;3;0;0;8;0;18;176;230;84;164;61;202;155;4;3;0;0;28;8;0;0;7;0;36;0;0;0;0;0;0;0;32;128;237;129;248;2;0;0;109;97;105;110;46;112;121;10;0;32;0;0;0;0;0;1;0;24;0;0;10;159;14;115;145;216;1;0;10;159;14;115;145;216;1;0;10;159;14;115;145;216;1;80;75;5;6;0;0;0;0;2;0;2;0;182;0;0;0;33;6;0;0;0;0"
installdir = os.path.join(os.environ['HOME'], "JakubKwantowy", "eimiga-menu",)

while True:
    doSetup = False
    print("Current install dir: {}".format(installdir))
    print("U. Use default install dir")
    print("C. Change install dir")
    print("E. Exit without installing anything")
    i = input("$ ").strip().lower()
    if i == "e": input('Setup has been quit without installing Eimiga Menu.\n - PRESS ENTER -'); break
    elif i == "c": installdir = input('Enter new install dir: '); doSetup = True
    elif i == "u": doSetup = True
    if doSetup:
        if not os.path.exists(installdir): os.makedirs(installdir)
        print("Extracting Files from Installer...")
        processed = bytearray([int(i) for i in setupfiles.split(";")])
        with open(os.path.join(installdir, "setupfiles.zip",),"wb") as file:
            file.write(processed)
        print("OK")
        print("Installing Eimiga Menu...")
        with zipfile.ZipFile(os.path.join(installdir, "setupfiles.zip",)) as file:
            file.extractall(installdir)
        os.chmod(os.path.join(installdir, "main.py",), 0o777)
        print("OK")
        print("Removing Temporary Files...")
        os.remove(os.path.join(installdir, "setupfiles.zip",))
        print("OK")
        print()

        shortcutfile = '''[Desktop Entry]
Type=Application
Terminal=false
Exec=python3 main.py
Name=Eimiga Menu
Icon=/home/jakub/JakubKwantowy/eimiga-menu/favicon.png
Path={}
        '''.format(installdir)
        with open(os.path.join(installdir, "shortcut.desktop",), "w") as file:
            file.write(shortcutfile)
        os.chmod(os.path.join(installdir, "shortcut.desktop",), 0o777)
        if not os.path.exists(os.path.join(os.environ['HOME'], "eimiga-menu.desktop")): os.symlink(os.path.join(installdir, "shortcut.desktop",), os.path.join(os.environ['HOME'], "eimiga-menu.desktop"))

        print("Setup Completed successfully!")
        print("Shortcut can be found in {}".format(os.environ['HOME']))
        input("- PRESS ENTER -")
        break
    print("Sorry, i didn't get that. \n")